(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    117641,       2604]
NotebookOptionsPosition[    112134,       2523]
NotebookOutlinePosition[    112586,       2540]
CellTagsIndexPosition[    112543,       2537]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PBC", " ", "=", " ", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NUnit", " ", "=", " ", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systemLengthX", " ", "=", " ", "NUnit"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systemLengthY", " ", "=", " ", "NUnit"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"systemLengthZ", " ", "=", " ", "4"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordConvention", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "NUnit"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "1", ",", "NUnit"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}], 
         ",", "2"}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1", ",", "NUnit"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "1", ",", "NUnit"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}], 
         ",", "2"}], "]"}]}], "}"}], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889503638807518*^9, 3.889503642065722*^9}, {
   3.8895036883168917`*^9, 3.8895037075164676`*^9}, {3.889503751672161*^9, 
   3.889503796418818*^9}, {3.889503847619384*^9, 3.8895038522208843`*^9}, {
   3.889503898728566*^9, 3.8895039277074127`*^9}, 3.8895039796047955`*^9, {
   3.8895041969409237`*^9, 3.889504199600069*^9}, {3.8895049475189934`*^9, 
   3.8895049523481865`*^9}, {3.8895050254404387`*^9, 3.889505028320352*^9}, {
   3.8895062719733925`*^9, 3.889506275356892*^9}, {3.8895064146085606`*^9, 
   3.889506417410887*^9}, {3.889508516167304*^9, 3.889508516233873*^9}, {
   3.8895087752534237`*^9, 3.889508790493709*^9}, {3.8895088212486286`*^9, 
   3.889508821883048*^9}, {3.889512433037408*^9, 3.889512433616707*^9}, {
   3.889512610866866*^9, 3.8895126136827354`*^9}, {3.889518878040924*^9, 
   3.889518878450556*^9}, {3.8895219346124115`*^9, 3.8895219360452924`*^9}, {
   3.889539430979274*^9, 3.889539431371729*^9}, {3.8895395491152725`*^9, 
   3.8895395492391186`*^9}, {3.8895399805017724`*^9, 
   3.8895399812777357`*^9}, {3.889540910327448*^9, 3.8895409135807867`*^9}, {
   3.889548972726031*^9, 3.8895489731953535`*^9}, {3.8896143197941275`*^9, 
   3.8896143199279556`*^9}, {3.889614454005335*^9, 3.8896144540989237`*^9}, {
   3.8896145456598587`*^9, 3.889614545718872*^9}, {3.889615475619048*^9, 
   3.8896154765237274`*^9}, {3.889615510905678*^9, 3.889615511757275*^9}, {
   3.8896163835378447`*^9, 3.889616384020056*^9}, {3.8896175268113003`*^9, 
   3.8896175479554596`*^9}, {3.8896732827663517`*^9, 
   3.8896732832551517`*^9}, {3.8896735076738615`*^9, 
   3.8896735077655115`*^9}, {3.889673679355197*^9, 3.8896736825084686`*^9}, {
   3.8896752878436327`*^9, 3.8896752879308443`*^9}, {3.8896754407102704`*^9, 
   3.8896754408178062`*^9}, {3.8896760425734835`*^9, 3.889676042659915*^9}, {
   3.8896788424248314`*^9, 3.8896788460426483`*^9}, {3.889688484130086*^9, 
   3.8896884842437625`*^9}, {3.889688590211191*^9, 3.8896885907852125`*^9}, {
   3.8896906147935386`*^9, 3.8896906151202636`*^9}, {3.8896912123043575`*^9, 
   3.8896912125711994`*^9}, {3.889692705879667*^9, 3.889692705994693*^9}, {
   3.889693870054243*^9, 3.8896938701662693`*^9}, {3.889694513686493*^9, 
   3.8896945189236975`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5a8bc8a3-0ff6-4941-b58e-92ea8b66094b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896760530890875`*^9, 3.889676053559016*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"c8bedccd-63d7-45ec-a0b6-eb7f6167c74c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"appliedVoltage", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RShunt", " ", "=", " ", "50"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frequency", " ", "=", " ", 
   RowBox[{"2.5", "*", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"driveFreq", " ", "=", " ", 
    RowBox[{"2", "\[Pi]", "*", "frequency"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L1Value", " ", "=", " ", 
   RowBox[{"27", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L2Value", " ", "=", " ", 
   RowBox[{"5.6", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L3Value", " ", "=", " ", 
    RowBox[{"27", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1Value", " ", "=", " ", 
   RowBox[{"150", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2Value", " ", "=", " ", 
   RowBox[{"75", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C3Value", " ", "=", " ", 
    RowBox[{"150", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "12"}]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ry", " ", "=", " ", "15.92"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputRow", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputColumn", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inputHeight", " ", "=", " ", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InputNodes", " ", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"inputRow", ",", "inputColumn", ",", "inputHeight", ",", "1"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"inputRow", ",", "inputColumn", ",", "inputHeight", ",", "2"}],
        "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputPos", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"coordConvention", ",", 
        RowBox[{"{", 
         RowBox[{"inputRow", ",", "inputColumn", ",", "1", ",", "1"}], 
         "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"coordConvention", ",", 
        RowBox[{"{", 
         RowBox[{"inputRow", ",", "inputColumn", ",", "1", ",", "2"}], 
         "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8756118161558113`*^9, 3.8756118528531933`*^9}, {
   3.875613178936739*^9, 3.875613182097568*^9}, {3.875613723083746*^9, 
   3.8756137232466354`*^9}, {3.8756161251386814`*^9, 3.875616158099218*^9}, {
   3.8756164723629093`*^9, 3.875616476646038*^9}, {3.875616511655475*^9, 
   3.875616537784684*^9}, {3.875616617989094*^9, 3.8756166290447145`*^9}, 
   3.875622588526909*^9, {3.877586027931987*^9, 3.877586142552441*^9}, {
   3.877586227268075*^9, 3.877586325451843*^9}, {3.8775863931711917`*^9, 
   3.8775863942183433`*^9}, {3.8777578773807793`*^9, 
   3.8777579371531134`*^9}, {3.8777582378420305`*^9, 3.877758238869815*^9}, {
   3.877758275061789*^9, 3.8777582786957827`*^9}, {3.877759482869893*^9, 
   3.8777594829704423`*^9}, {3.877759765193468*^9, 3.8777597800166073`*^9}, {
   3.877770954689909*^9, 3.8777709641350675`*^9}, {3.8777710580700536`*^9, 
   3.877771299216861*^9}, {3.8777713388222327`*^9, 3.8777713497627153`*^9}, {
   3.877771388282121*^9, 3.8777714853336296`*^9}, {3.8777829769563913`*^9, 
   3.877782977921266*^9}, {3.877783247735304*^9, 3.8777832485695763`*^9}, {
   3.8777844917237706`*^9, 3.877784491983243*^9}, {3.8778497572787*^9, 
   3.877849758772581*^9}, {3.8778498841389036`*^9, 3.8778498961079345`*^9}, {
   3.8779532628147826`*^9, 3.87795326462017*^9}, {3.877953333625659*^9, 
   3.8779533338638935`*^9}, {3.877953444536544*^9, 3.8779534446684027`*^9}, {
   3.877956110710682*^9, 3.877956110798855*^9}, {3.8780058631204147`*^9, 
   3.878005863262847*^9}, 3.8780080146783676`*^9, {3.87800809357193*^9, 
   3.8780080937151637`*^9}, {3.8780082442640543`*^9, 
   3.8780082444925423`*^9}, {3.8780186638803825`*^9, 3.87801866410769*^9}, {
   3.8780187068276715`*^9, 3.878018706947413*^9}, {3.878019182516263*^9, 
   3.878019182985648*^9}, 3.878019335703253*^9, {3.878019811310011*^9, 
   3.8780198372892323`*^9}, {3.8780440184209666`*^9, 
   3.8780440253757925`*^9}, {3.8780459558972225`*^9, 
   3.8780459560732317`*^9}, {3.8780462246559076`*^9, 3.878046224706891*^9}, {
   3.878110569000331*^9, 3.8781105691195436`*^9}, {3.878110795513341*^9, 
   3.8781107957135515`*^9}, {3.8781110003561754`*^9, 
   3.8781110005401917`*^9}, {3.878180457182232*^9, 3.878180511345091*^9}, {
   3.878180679506774*^9, 3.87818068296504*^9}, {3.8781811512398343`*^9, 
   3.878181180051657*^9}, {3.8782001063448324`*^9, 3.8782001218320913`*^9}, {
   3.87820026249444*^9, 3.878200262881034*^9}, {3.8782007053070374`*^9, 
   3.8782007090363865`*^9}, {3.878200787743039*^9, 3.878200787823611*^9}, {
   3.878200819352575*^9, 3.8782008194085464`*^9}, {3.8782020011325674`*^9, 
   3.8782020070077324`*^9}, {3.8782733523195415`*^9, 3.878273352391464*^9}, {
   3.8782904691682262`*^9, 3.8782904771792984`*^9}, {3.8782905912553177`*^9, 
   3.8782905925996847`*^9}, {3.8782907074212637`*^9, 3.8782907084622364`*^9}, 
   3.878292331911734*^9, {3.8782923660685496`*^9, 3.878292366162647*^9}, {
   3.878375948169323*^9, 3.878375976246229*^9}, {3.8787851593987308`*^9, 
   3.8787851595427437`*^9}, {3.878786041807777*^9, 3.8787860796196337`*^9}, {
   3.87878629011119*^9, 3.878786293817872*^9}, {3.8787873386161537`*^9, 
   3.878787340447682*^9}, {3.8787986584412622`*^9, 3.8787986607914295`*^9}, {
   3.878891219400174*^9, 3.878891228574625*^9}, {3.8788917229503117`*^9, 
   3.8788917265321054`*^9}, {3.8788922188950057`*^9, 
   3.8788922372938747`*^9}, {3.8892536533829403`*^9, 3.889253653714015*^9}, 
   3.8892536962382755`*^9, {3.889267176764984*^9, 3.8892671773955283`*^9}, 
   3.889276414230367*^9, {3.8895045869480667`*^9, 3.889504591322544*^9}, {
   3.8895049633596277`*^9, 3.889504965614444*^9}, {3.8895061355314646`*^9, 
   3.88950614049874*^9}, {3.8895082777861767`*^9, 3.8895082809196672`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8c2efa85-94ab-4fb2-8a07-fef51bba2526"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 16, 1, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.902809607939522*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"83b53fe5-ad0e-41cb-a8d2-18cd1f56d938"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 16, 2, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9028096084996147`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"3bd083f4-7551-451d-a6e2-76b2647b1179"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"C1Value", "*", "L1Value"}], ")"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", "Pi"}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.902809617163553*^9, 3.9028096563851595`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"c7600bcb-cb72-4887-a260-c2b18d7003e3"],

Cell[BoxData["2.5008786559919617`*^6"], "Output",
 CellChangeTimes->{{3.902809652520854*^9, 3.9028096566365285`*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"2aa05d0e-3b68-48ca-9f77-5375deb6a2af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.889504188409504*^9, 3.8895041886199617`*^9}, {
  3.889675650776245*^9, 3.889675811287535*^9}, {3.8896760058583856`*^9, 
  3.889676093837587*^9}, {3.889676590160914*^9, 3.889676590315962*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"17d59b2e-305a-488c-b1c1-2ca7151afe26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"circuitGroundMatrixFourier", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"x", "==", "y"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "1"}], ",", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"I", "*", "driveFreq", "*", "L2Value"}], ")"}], 
           RowBox[{"-", "1"}]], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "2"}], ",", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"I", "*", "driveFreq", "*", "L3Value"}], ")"}], 
           RowBox[{"-", "1"}]], ",", "True", ",", "0"}], "]"}], ",", "True", 
        ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"adjacencyMatrixXToYSameCellFourier", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", "y", "]"}], "]"}], "-", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], "||", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", "y", "]"}], "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}]}], ",", 
        RowBox[{"I", "*", "driveFreq", "*", "C1Value"}], ",", 
        "\[IndentingNewLine]", "True", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n", " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adjacencyMatrixXToYDifferentCellFourier", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "1"}], "}"}]}], 
            ",", "8", ",", "1"}], "]"}]}], " ", "||", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "1"}], "}"}]}], 
            ",", "8", ",", "1"}], "]"}]}], " ", "||", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ",", "8", 
            ",", "1"}], "]"}]}], "||", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ",", "8", 
            ",", "1"}], "]"}]}]}], " ", ",", 
        RowBox[{"I", "*", "driveFreq", "*", "C2Value"}], ",", 
        "\[IndentingNewLine]", "True", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"adjacencyMatrixXToXFourier", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "+", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], ",", 
            "NUnit", ",", "1"}], "]"}]}], " ", "||", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordConvention", "[", 
              RowBox[{"[", "y", "]"}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], " ", ",", 
            "NUnit", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "1"}], ",", 
          RowBox[{"I", "*", "driveFreq", "*", "C3Value"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coordConvention", "[", 
            RowBox[{"[", 
             RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "2"}], ",", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"I", "*", "driveFreq", "*", "L1Value"}], ")"}], 
           RowBox[{"-", "1"}]], ",", "\[IndentingNewLine]", "True", ",", 
          "0"}], "]"}], ",", "True", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adjacencyMatrixZ", "=", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"coordConvention", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", "2"}], "]"}], "]"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"coordConvention", "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], ",", " ", 
                "systemLengthZ", ",", " ", "1"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"coordConvention", "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "+", "1"}], ",", "2", ",", 
                "1"}], "]"}], "}"}]}], "}"}], "]"}]}], "||", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "==", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"coordConvention", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", "2"}], "]"}], "]"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"coordConvention", "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "-", "1"}], ",", " ", 
                "systemLengthZ", ",", " ", "1"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"coordConvention", "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "+", "1"}], ",", "2", ",", 
                "1"}], "]"}], "}"}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"I", "*", "driveFreq", "*", "C1Value"}], ",", "True", ",", 
        "0"}], "]"}], "\n", "  ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"totalNodeConductanceMatrixFourier", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"x", "==", "y"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2", "*", "I", "*", "driveFreq", "*", "C3Value"}], "+", 
          RowBox[{"2", "*", "I", "*", "driveFreq", "*", "C2Value"}], "+", 
          RowBox[{"2", "*", "I", "*", "driveFreq", "*", "C1Value"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coordConvention", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "4"}], "]"}], "]"}], "==", "2"}], ",", 
         RowBox[{
          RowBox[{"2", "*", "I", "*", "driveFreq", "*", "C2Value"}], "+", 
          RowBox[{"2", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"I", "*", "driveFreq", "*", "L1Value"}], ")"}], 
            RowBox[{"-", "1"}]]}], "+", "\[IndentingNewLine]", 
          RowBox[{"2", "*", "I", "*", "driveFreq", "*", "C1Value"}]}], 
         "\[IndentingNewLine]", ",", "True", ",", "0"}], "]"}], ",", "True", 
       ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", 
       RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", 
       RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8756225803965816`*^9, {3.878018916776109*^9, 3.8780189818919144`*^9}, {
   3.878019021903261*^9, 3.878019065115608*^9}, {3.8780196984216895`*^9, 
   3.878019699853072*^9}, {3.878019746495765*^9, 3.8780197667669363`*^9}, {
   3.8780441299798307`*^9, 3.8780441358077955`*^9}, 3.878044289216595*^9, {
   3.8780454661167316`*^9, 3.8780454842869587`*^9}, {3.8780456469664264`*^9, 
   3.878045696933445*^9}, {3.878045741139923*^9, 3.878045762458295*^9}, {
   3.8781101415607295`*^9, 3.878110217061037*^9}, {3.8781102495388412`*^9, 
   3.878110269024111*^9}, {3.878110316842619*^9, 3.878110330826288*^9}, 
   3.8781107428233104`*^9, 3.878110938881173*^9, 3.878181571685152*^9, 
   3.8781997567974544`*^9, {3.87819981387392*^9, 3.8781998205541553`*^9}, 
   3.8781998668004885`*^9, {3.8781999972499332`*^9, 3.8782000229410267`*^9}, {
   3.8782008808754826`*^9, 3.8782008809474688`*^9}, {3.878202280839237*^9, 
   3.8782022809112463`*^9}, 3.878203104370039*^9, 3.8782036339569473`*^9, {
   3.8782037158039265`*^9, 3.8782037207152386`*^9}, {3.8782037892107434`*^9, 
   3.878203806568428*^9}, 3.8782038375722647`*^9, {3.878203878012801*^9, 
   3.878203882315367*^9}, {3.878204043615202*^9, 3.8782040489174294`*^9}, {
   3.8782073829789934`*^9, 3.8782074374175887`*^9}, {3.878207508683902*^9, 
   3.8782075357507257`*^9}, {3.8782075734722123`*^9, 
   3.8782075875095134`*^9}, {3.8782090845818152`*^9, 
   3.8782090873477764`*^9}, {3.8782091934836483`*^9, 
   3.8782091938545113`*^9}, {3.87820923716974*^9, 3.878209238120067*^9}, {
   3.878209307799445*^9, 3.8782093152324085`*^9}, {3.8782093696758785`*^9, 
   3.8782093842025566`*^9}, {3.8782094183943434`*^9, 
   3.8782094187313137`*^9}, {3.8782095516654396`*^9, 3.878209574387998*^9}, {
   3.878209604622286*^9, 3.878209605240319*^9}, {3.8782716635863132`*^9, 
   3.8782716636967087`*^9}, {3.8782717274550004`*^9, 3.878271783725004*^9}, {
   3.8782718613465366`*^9, 3.878271873383797*^9}, {3.8782722155280695`*^9, 
   3.878272219054756*^9}, {3.8782722748399563`*^9, 3.8782722750799775`*^9}, {
   3.878272365888632*^9, 3.878272366185186*^9}, {3.8782723963363647`*^9, 
   3.878272402806913*^9}, {3.8782737429314938`*^9, 3.8782737445410585`*^9}, {
   3.8782796674887743`*^9, 3.878279667660488*^9}, 3.8782810577860937`*^9, {
   3.8782812799430294`*^9, 3.8782813720741477`*^9}, {3.8782814371872473`*^9, 
   3.878281471248272*^9}, {3.878281506341739*^9, 3.8782815975032415`*^9}, {
   3.8782816865965195`*^9, 3.878281695609675*^9}, {3.8782818943809557`*^9, 
   3.878281926243043*^9}, {3.878282094844409*^9, 3.878282148094696*^9}, {
   3.87828227725723*^9, 3.87828230791923*^9}, {3.878282340646984*^9, 
   3.878282448812321*^9}, {3.878282603010978*^9, 3.8782826362367153`*^9}, {
   3.8782826748190904`*^9, 3.878282681903864*^9}, 3.878282873057607*^9, 
   3.878283005492568*^9, {3.8782830889700623`*^9, 3.878283120511694*^9}, {
   3.8782831579623547`*^9, 3.8782831903992405`*^9}, {3.878283225798567*^9, 
   3.878283230351051*^9}, {3.8782833475572805`*^9, 3.878283362566535*^9}, {
   3.878283923666174*^9, 3.87828402215578*^9}, {3.878284227955702*^9, 
   3.8782843011026936`*^9}, 3.878284373554519*^9, 3.878289745597975*^9, {
   3.8787851393279715`*^9, 3.878785142140894*^9}, {3.878785934098919*^9, 
   3.878785971179261*^9}, {3.8787862324972878`*^9, 3.87878627619888*^9}, {
   3.878786322658358*^9, 3.8787863896836853`*^9}, {3.878789979746306*^9, 
   3.8787899938079104`*^9}, {3.878790131584206*^9, 3.8787901451135564`*^9}, {
   3.8787902460890455`*^9, 3.8787903294066553`*^9}, {3.8787983741380005`*^9, 
   3.8787983921109304`*^9}, {3.878964676972499*^9, 3.87896471567807*^9}, {
   3.878964757609538*^9, 3.878964810461641*^9}, {3.878964998169512*^9, 
   3.8789650073500285`*^9}, {3.878965352271199*^9, 3.878965365032977*^9}, 
   3.8789656863538327`*^9, {3.879829096298188*^9, 3.879829124348922*^9}, 
   3.8892635200776725`*^9, {3.889272322477357*^9, 3.8892723344666953`*^9}, {
   3.88927240496457*^9, 3.88927240625978*^9}, {3.8892726304824123`*^9, 
   3.8892726472108784`*^9}, {3.8892727252480392`*^9, 
   3.8892727353905635`*^9}, {3.889272782373455*^9, 3.8892727916590757`*^9}, {
   3.889272840032354*^9, 3.8892728673389287`*^9}, {3.8892729356377435`*^9, 
   3.889272943028916*^9}, {3.8892738333766613`*^9, 3.8892738384275675`*^9}, 
   3.88927390791636*^9, {3.8892739927814384`*^9, 3.8892740008402805`*^9}, {
   3.8892744180458755`*^9, 3.8892744272524447`*^9}, {3.8892824673197784`*^9, 
   3.889282468162016*^9}, {3.889282533285699*^9, 3.8892825552731314`*^9}, {
   3.8895196813496594`*^9, 3.8895197016429873`*^9}, {3.8895216599730387`*^9, 
   3.8895216703549876`*^9}, {3.889521802668312*^9, 3.88952180573747*^9}, {
   3.889521856331444*^9, 3.8895218622027884`*^9}, {3.8895221173567963`*^9, 
   3.889522139320716*^9}, {3.889522311463956*^9, 3.8895223218306046`*^9}, {
   3.8896175603264236`*^9, 3.889617572538616*^9}, {3.8896179934822855`*^9, 
   3.889618002618683*^9}, {3.889673784843461*^9, 3.889673853344779*^9}, {
   3.8896739158941407`*^9, 3.8896739317543516`*^9}, {3.889675203850054*^9, 
   3.8896752433247156`*^9}, {3.889675494504244*^9, 3.8896754945882587`*^9}, {
   3.8896761387725363`*^9, 3.889676170834673*^9}, {3.889676265311165*^9, 
   3.889676278622677*^9}, {3.8896878581620407`*^9, 3.889687863364343*^9}, {
   3.889689040004263*^9, 3.889689040387602*^9}, {3.889689732990641*^9, 
   3.889689752433915*^9}, {3.889689787221068*^9, 3.8896898298328447`*^9}, 
   3.8896899465769324`*^9, {3.8896902186045446`*^9, 3.8896902212378798`*^9}, {
   3.889690589328154*^9, 3.8896906102579584`*^9}, {3.889692656574932*^9, 
   3.889692661615577*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"da730eb1-5fb4-4cac-a0a4-1deb7cb7d319"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896908731894217`*^9, 3.8896908734363017`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"979ac351-b1b9-499a-b256-70ae96d9602f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"laplacianMatrixFourier", "=", " ", 
    RowBox[{"totalNodeConductanceMatrixFourier", "-", 
     RowBox[{"(", 
      RowBox[{
      "adjacencyMatrixXToXFourier", "+", 
       "adjacencyMatrixXToYDifferentCellFourier", "+", 
       "adjacencyMatrixXToYSameCellFourier", "+", "adjacencyMatrixZ"}], ")"}],
      "+", "circuitGroundMatrixFourier"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverseLaplacianMatrixFourier", "=", " ", 
   RowBox[{"Inverse", "[", "laplacianMatrixFourier", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88954141123848*^9, 3.8895414117441072`*^9}, {
  3.8896154116617036`*^9, 3.8896154142919807`*^9}, {3.8896162859379473`*^9, 
  3.8896163368052344`*^9}, {3.8896178142345576`*^9, 3.8896178148527164`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"37648ec5-5756-45f3-b7f5-5d5c884aa147"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8895042245029087`*^9, 3.8895042248854885`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"a2d44bb7-3391-49e1-a24a-d9c7aa0ce0af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"currentVectorCosSubA", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coordConvention", "[", 
          RowBox[{"[", "node", "]"}], "]"}], "==", 
         RowBox[{"InputNodes", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"appliedVoltage", "/", 
         RowBox[{"(", 
          RowBox[{"RShunt", "+", 
           RowBox[{"inverseLaplacianMatrixFourier", "[", 
            RowBox[{"[", 
             RowBox[{"node", ",", "node"}], "]"}], "]"}]}], ")"}]}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"node", ",", " ", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentVectorCosSubB", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coordConvention", "[", 
          RowBox[{"[", "node", "]"}], "]"}], "==", 
         RowBox[{"InputNodes", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"appliedVoltage", "/", 
         RowBox[{"(", 
          RowBox[{"RShunt", "+", 
           RowBox[{"inverseLaplacianMatrixFourier", "[", 
            RowBox[{"[", 
             RowBox[{"node", ",", "node"}], "]"}], "]"}]}], ")"}]}], ",", 
        "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"node", ",", " ", "1", ",", 
        RowBox[{"Length", "[", "coordConvention", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentVector", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"currentVectorCosSubA", ",", "currentVectorCosSubB"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"voltageVectorCos", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"currentVectorCosSubA", ",", "inverseLaplacianMatrixFourier"}], 
      "]"}], ",", 
     RowBox[{"Dot", "[", 
      RowBox[{"currentVectorCosSubB", ",", "inverseLaplacianMatrixFourier"}], 
      "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8781807137072077`*^9, 3.8781807555098495`*^9}, {
   3.8781808951759596`*^9, 3.8781808967895966`*^9}, 3.878181647404112*^9, {
   3.8788918321004324`*^9, 3.8788919116414266`*^9}, {3.878892007769721*^9, 
   3.8788920183519344`*^9}, 3.878892133166127*^9, 3.8788921898819757`*^9, {
   3.8788933135965214`*^9, 3.8788933497773466`*^9}, 3.878965926368106*^9, {
   3.878965959805165*^9, 3.878965973744897*^9}, {3.878966188747345*^9, 
   3.878966211507414*^9}, {3.8892661548215904`*^9, 3.8892661553895617`*^9}, {
   3.8892662334638004`*^9, 3.8892662354158397`*^9}, {3.8895046177187624`*^9, 
   3.8895046606033983`*^9}, {3.8895048635870943`*^9, 
   3.8895048958647027`*^9}, {3.889505250927161*^9, 3.889505285864581*^9}, {
   3.8895057671029425`*^9, 3.889505780072107*^9}, {3.8895058970532503`*^9, 
   3.8895059305520897`*^9}, {3.889519598792914*^9, 3.8895196005434113`*^9}, {
   3.88954140799572*^9, 3.8895414088870087`*^9}, {3.8896884716044188`*^9, 
   3.889688479496395*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"eb0e819c-2372-4237-b1b8-d2357759fece"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8895409582773323`*^9, 3.889540958462478*^9}, {
  3.8896912646371236`*^9, 3.88969128071072*^9}, {3.88969131461789*^9, 
  3.8896914053121285`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"85a9a6a9-3a51-4a23-a6e2-958dfeb210d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coordConvention", "[", 
  RowBox[{"[", 
   RowBox[{";;", "10"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8896943304582825`*^9, 3.8896943336427507`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"a86c699f-9b03-41ae-a977-7681a26500b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.889694334166112*^9, 3.8944433921755238`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"4f227c5d-adab-4e28-89db-830227246d41"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fourierVoltagesV1", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"k", "=", "1"}], "systemLengthZ"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"l", "=", "1"}], "NUnit"], 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", "1"}], "NUnit"], 
             RowBox[{
              RowBox[{"voltageVectorCos", "[", 
               RowBox[{"[", 
                RowBox[{"subInput", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sub", "-", "1"}], ")"}], "*", 
                    SuperscriptBox["NUnit", "2"], "*", "systemLengthZ"}], 
                   ")"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "NUnit", "*", 
                    "systemLengthZ"}], ")"}], "+", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"l", "-", "1"}], ")"}], "*", "systemLengthZ"}], 
                   ")"}], "+", "k"}]}], "]"}], "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
                RowBox[{"(", 
                 RowBox[{"kx", "-", "1"}], ")"}], "*", 
                RowBox[{
                 RowBox[{"(", "j", ")"}], "/", "NUnit"}]}], "]"}]}]}], ")"}], 
           "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
             RowBox[{"(", 
              RowBox[{"ky", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", "l", ")"}], "/", "NUnit"}]}], "]"}]}]}], ")"}], 
        "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
          RowBox[{"(", 
           RowBox[{"kz", "-", "1"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", "k", ")"}], "/", "systemLengthZ"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"subInput", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"sub", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fourierCurrentVector", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"k", "=", "1"}], "systemLengthZ"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"l", "=", "1"}], "NUnit"], 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "1"}], "NUnit"], 
            RowBox[{
             RowBox[{"currentVector", "[", 
              RowBox[{"[", 
               RowBox[{"sub", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"sub", "-", "1"}], ")"}], "*", 
                   SuperscriptBox["NUnit", "2"], "*", "systemLengthZ"}], 
                  ")"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "NUnit", "*", 
                   "systemLengthZ"}], ")"}], "+", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"l", "-", "1"}], ")"}], "*", "systemLengthZ"}], 
                  ")"}], "+", "k"}]}], "]"}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
               RowBox[{"(", 
                RowBox[{"kx", "-", "1"}], ")"}], "*", 
               RowBox[{
                RowBox[{"(", "j", ")"}], "/", "NUnit"}]}], "]"}]}]}], ")"}], 
          "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
            RowBox[{"(", 
             RowBox[{"ky", "-", "1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", "l", ")"}], "/", "NUnit"}]}], "]"}]}]}], ")"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", "2", "*", "\[Pi]", "*", 
         RowBox[{"(", 
          RowBox[{"kz", "-", "1"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", "k", ")"}], "/", "systemLengthZ"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"sub", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877014680226323*^9, 3.877014807614601*^9}, {
   3.877014938289811*^9, 3.8770149425269847`*^9}, 3.877015005252528*^9, {
   3.8770150851656485`*^9, 3.8770150854889317`*^9}, {3.8770611767197514`*^9, 
   3.87706117713369*^9}, {3.8770612088528075`*^9, 3.877061211830135*^9}, {
   3.8770612509578333`*^9, 3.8770612723683643`*^9}, {3.8770613239736404`*^9, 
   3.8770613520209503`*^9}, {3.877072587294429*^9, 3.8770725951534524`*^9}, {
   3.8779566609598193`*^9, 3.877956683961197*^9}, {3.8780120506694326`*^9, 
   3.8780120639489594`*^9}, {3.878036120201049*^9, 3.8780361344455767`*^9}, {
   3.8780366838340917`*^9, 3.878036688466118*^9}, 3.8780367417167764`*^9, {
   3.8781024780268*^9, 3.878102490211649*^9}, 3.878110635919726*^9, 
   3.8781113476928415`*^9, {3.878181231025565*^9, 3.8781812323125906`*^9}, {
   3.8781819680470905`*^9, 3.8781819874976344`*^9}, {3.8787876023029327`*^9, 
   3.878787626941679*^9}, {3.8788941039802666`*^9, 3.8788941605590067`*^9}, {
   3.8788941987086315`*^9, 3.878894198716631*^9}, {3.878894356028722*^9, 
   3.878894464950365*^9}, {3.878894821612427*^9, 3.878894859926751*^9}, {
   3.8793045076835213`*^9, 3.879304594211174*^9}, {3.889277037514821*^9, 
   3.889277049964078*^9}, {3.8892836130333347`*^9, 3.8892836325621347`*^9}, {
   3.8892840187139397`*^9, 3.889284056512608*^9}, {3.889284195953868*^9, 
   3.8892842078518257`*^9}, {3.889505227502226*^9, 3.889505228678867*^9}, 
   3.889505469346024*^9, {3.8895054997848635`*^9, 3.8895055152526293`*^9}, {
   3.8895055858680506`*^9, 3.8895056307298107`*^9}, 3.8895056682406607`*^9, {
   3.8895057948277006`*^9, 3.8895057957313414`*^9}, 3.8895066288386583`*^9, {
   3.889514448532983*^9, 3.889514487901218*^9}, {3.8895155077757897`*^9, 
   3.8895155196502657`*^9}, {3.889521906211091*^9, 3.8895219106604786`*^9}, {
   3.8895395785015936`*^9, 3.8895395910204*^9}, {3.889539648841013*^9, 
   3.889539649170228*^9}, 3.8895418649071255`*^9, {3.889688719116544*^9, 
   3.8896887284346967`*^9}, {3.8896887817446175`*^9, 
   3.8896887863893557`*^9}, {3.889691570162794*^9, 3.8896916008599143`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"8029e452-70c9-4ece-a71b-a5d25548e1cb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.889541639409898*^9, 3.8896093043733053`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"5dfee06a-2bd0-4586-809a-9b07d7bb18d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GreensPBC", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"fourierVoltagesV1", "[", 
         RowBox[{"[", 
          RowBox[{"subInput", ",", "sub", ",", "kx", ",", "ky", ",", "kz"}], 
          "]"}], "]"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"fourierCurrentVector", "[", 
         RowBox[{"[", 
          RowBox[{"sub", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"subInput", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"sub", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LapGreensEigenvalues", " ", "=", " ", 
   RowBox[{"Im", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"Inverse", "[", 
          RowBox[{"GreensPBC", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", ";;", ",", "kx", ",", "ky", ",", "kz"}], "]"}],
            "]"}], "]"}], "]"}], ",", "Im"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8896916596176105`*^9, 3.8896918617815056`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"73fe7c12-3fec-4780-94dc-712e906e11ba"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896918884858446`*^9, 3.8896918886492577`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"25bdecf6-4d38-48fe-aefa-114509e5b4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListPlot3D", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"LapGreensEigenvalues", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", ";;", ",", "kz"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ky\>\"", ",", "\"\<kx\>\"", ",", "\"\<Energy\>\""}], 
        "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"kTicks", ",", "kTicks", ",", "Automatic"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<kz = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"\[Pi]", "*", 
          RowBox[{"kz", "/", "systemLengthZ"}]}], "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"kz", ",", "1", ",", "systemLengthZ", ",", "1"}], "}"}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{3.8896918953583093`*^9, 3.8896919259796467`*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"d87f1c92-24a6-4e81-a13a-b4101b0034df"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.889691661001604*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"f24fbea8-4e16-4901-8848-e8e01649ae67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Detk", "=", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fourierVoltagesV1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
           "]"}], "*", 
          RowBox[{"fourierVoltagesV1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
           "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fourierCurrentVector", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}], "*", 
          RowBox[{"fourierCurrentVector", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}], 
         ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fourierVoltagesV1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
           "]"}], "*", 
          RowBox[{"fourierVoltagesV1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
           "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fourierCurrentVector", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}], "*", 
          RowBox[{"fourierCurrentVector", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}], 
         ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lap", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Detk", "[", 
        RowBox[{"[", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}], "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"fourierVoltagesV1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
            "]"}], "/", 
           RowBox[{"fourierCurrentVector", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"fourierVoltagesV1", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "kx", ",", "ky", ",", "kz"}], "]"}],
              "]"}]}], "/", 
           RowBox[{"fourierCurrentVector", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"fourierVoltagesV1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", "kx", ",", "ky", ",", "kz"}], "]"}],
              "]"}]}], "/", 
           RowBox[{"fourierCurrentVector", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}], 
          ",", 
          RowBox[{
           RowBox[{"fourierVoltagesV1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], 
            "]"}], "/", 
           RowBox[{"fourierCurrentVector", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "kx", ",", "ky", ",", "kz"}], "]"}], "]"}]}]}],
          "}"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.877061438729274*^9, 3.877061439297826*^9}, {
   3.8770615958192005`*^9, 3.877061601235035*^9}, {3.877061836395337*^9, 
   3.8770619158915014`*^9}, {3.8770619578607817`*^9, 3.8770620903917475`*^9}, 
   3.877071292253872*^9, {3.8770713409632845`*^9, 3.8770714893241444`*^9}, 
   3.8770715779292674`*^9, {3.8770733055291147`*^9, 3.877073307399684*^9}, {
   3.8774220495707016`*^9, 3.87742206316002*^9}, {3.8774221003912463`*^9, 
   3.8774221196392217`*^9}, {3.8774263259412837`*^9, 
   3.8774263716932116`*^9}, {3.8774269147176824`*^9, 3.8774269174771442`*^9}, 
   3.8774968849698596`*^9, 3.8775049169989843`*^9, 3.878020715454626*^9, {
   3.8780281405116153`*^9, 3.878028145801955*^9}, {3.8780287036123147`*^9, 
   3.8780287097816095`*^9}, {3.878036772043479*^9, 3.878036778920978*^9}, 
   3.878036813835666*^9, {3.8781820191710844`*^9, 3.878182025656932*^9}, {
   3.878182123247735*^9, 3.878182124570523*^9}, {3.8781826462703032`*^9, 
   3.8781826546348934`*^9}, {3.878894153239134*^9, 3.8788941606061783`*^9}, {
   3.878894198740634*^9, 3.87889419877264*^9}, {3.8788950482486296`*^9, 
   3.8788950486013193`*^9}, {3.8788950974535313`*^9, 3.878895098229678*^9}, {
   3.8892836400389166`*^9, 3.8892836484272637`*^9}, {3.8895418649661593`*^9, 
   3.8895418650071497`*^9}, {3.8896265820718565`*^9, 3.889626641447715*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"5293880b-db2c-418b-b625-f28d50d90714"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896096661158495`*^9, 3.889609666406062*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"5dd63fd1-ee61-4209-816c-9258b50e8ee1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Omega", " ", "=", " ", 
   RowBox[{"2", "*", "\[Pi]", "*", "frequency"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LBZ", " ", "=", " ", "L1Value"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", " ", "=", " ", 
   RowBox[{"Omega", "*", "C1Value"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CAz", " ", "=", " ", "C1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cy", " ", "=", " ", 
   RowBox[{"C1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Alpha", " ", "=", " ", 
    RowBox[{"Omega", "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["Omega", "2"], "*", "LBZ"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PauliMatrix", "[", "0", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "1", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "2", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", "Mu_", "]"}], ":=", 
   RowBox[{"Xi", "[", 
    RowBox[{"[", 
     RowBox[{"Mu", "+", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Hc", "[", 
     RowBox[{"{", 
      RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "}"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"CAz", "-", "Alpha"}], ")"}]}], 
         RowBox[{"Cos", "[", "ky", "]"}]}], ")"}], " ", 
       RowBox[{"X", "[", "0", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"C1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Cos", "[", "kz", "]"}]}], ")"}]}], "+", 
         RowBox[{"Cy", " ", "*", 
          RowBox[{"(", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"ky", "-", "kx"}], "]"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"X", "[", "1", "]"}]}], "-", 
      RowBox[{"C1", " ", 
       RowBox[{"Sin", "[", "kz", "]"}], " ", 
       RowBox[{"X", "[", "2", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CAz", "+", "Alpha"}], ")"}], " ", 
       RowBox[{"Cos", "[", "ky", "]"}], " ", 
       RowBox[{"X", "[", "3", "]"}]}]}], "]"}]}], "*)"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hc", "[", 
    RowBox[{"{", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "}"}], "]"}], ":=", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", "C1Value"}], "+", 
          RowBox[{"2", "C2Value"}], "+", 
          RowBox[{"2", "C3Value"}]}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"2", "C1Value"}], "+", 
          RowBox[{"2", "C2Value"}], "-", 
          FractionBox["2", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"2", "\[Pi]", "*", "frequency"}], ")"}], "2"], 
            "L1Value"}]]}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "-", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "*", "C3Value", "*", 
          RowBox[{"Cos", "[", "ky", "]"}]}], ",", 
         RowBox[{"C1Value", "+", 
          RowBox[{"C1Value", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"I", "*", "kz"}], "]"}]}], "+", 
          RowBox[{"2", "C2Value", "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"ky", "-", "kx"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"C1Value", "+", 
          RowBox[{"C1Value", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "kz"}], "]"}]}], "+", 
          RowBox[{"2", "C2Value", "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"ky", "-", "kx"}], "]"}]}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"2", "\[Pi]", "*", "frequency"}], ")"}], "2"], "*", 
            "L1Value"}]], 
          RowBox[{"Cos", "[", "ky", "]"}]}]}], "}"}]}], "\[IndentingNewLine]",
       "}"}], "+", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"2", "\[Pi]", "*", "frequency"}], ")"}], "2"], 
            "L2Value"}]]}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"2", "\[Pi]", "*", "frequency"}], ")"}], "2"], 
            "L3Value"}]]}]}], "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8598609623276014`*^9, 3.8598610727221346`*^9}, {
   3.8598611064126153`*^9, 3.859861124740429*^9}, {3.859861155074855*^9, 
   3.8598612042854447`*^9}, 3.8598612877312255`*^9, {3.859861339935139*^9, 
   3.859861345851588*^9}, {3.8598616067331567`*^9, 3.8598616070931673`*^9}, {
   3.8598616589664326`*^9, 3.859861688290021*^9}, {3.859866006656866*^9, 
   3.8598660188694687`*^9}, {3.8598662001610985`*^9, 
   3.8598662193266153`*^9}, {3.859867176226392*^9, 3.859867207585125*^9}, {
   3.8598672425672703`*^9, 3.8598672763564177`*^9}, {3.8598673204349203`*^9, 
   3.8598673427771015`*^9}, {3.8598674288444867`*^9, 3.859867453858183*^9}, {
   3.85995287047013*^9, 3.8599528835454893`*^9}, 3.8599530722403903`*^9, {
   3.859953148236494*^9, 3.85995315723639*^9}, {3.859953236064331*^9, 
   3.8599532634137783`*^9}, {3.8599533080812287`*^9, 
   3.8599533098341846`*^9}, {3.8599534284678445`*^9, 
   3.8599534396197724`*^9}, {3.85995347281205*^9, 3.85995348655186*^9}, 
   3.8599536073057265`*^9, {3.8599536703719344`*^9, 3.859953674992859*^9}, {
   3.85995374966819*^9, 3.859953749947233*^9}, {3.8599822729145*^9, 
   3.8599822773133907`*^9}, {3.862822030402918*^9, 3.862822031852786*^9}, {
   3.879305005869912*^9, 3.8793050146707697`*^9}, {3.879827282755864*^9, 
   3.879827283886713*^9}, {3.8798273162059674`*^9, 3.879827333238243*^9}, 
   3.8798273747998247`*^9, {3.889506197947827*^9, 3.889506202979457*^9}, {
   3.889690992603345*^9, 3.889690997603804*^9}, {3.889691028170681*^9, 
   3.889691028832575*^9}, {3.889691115110312*^9, 3.889691128307268*^9}, {
   3.8896927452822943`*^9, 3.8896927475958033`*^9}, {3.889694691516429*^9, 
   3.8896946995712214`*^9}, {3.889694754891136*^9, 3.889694767140605*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"58ad1f8b-3a1b-440a-9db6-02bd75456665"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8895061946142206`*^9, 3.889506195182395*^9}, {
  3.8896909788598747`*^9, 3.889691025913707*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"e93742e9-354b-43c5-a7b9-763b2eb32bcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kTicks", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "-", "1"}], ")"}], 
         FractionBox[
          RowBox[{"2", "\[Pi]"}], "NUnit"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "NUnit"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LapEigenvalues", " ", "=", " ", 
    RowBox[{"Im", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"Lap", "[", 
           RowBox[{"[", 
            RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], "]"}], "]"}], ",", 
         "Im"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kx", ",", "1", ",", "NUnit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ky", ",", "1", ",", "NUnit"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kz", ",", "1", ",", "systemLengthZ"}], "}"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataEigenvalues", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"Hc", "[", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], "]"}], "]"}], ",", 
       "Re"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], "-", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "NUnit"}]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", "NUnit"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], "-", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "NUnit"}]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", "NUnit"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}], ",", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", "systemLengthZ"}]}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8895061061566076`*^9, 3.8895061073086157`*^9}, {
   3.889506192742132*^9, 3.8895062217554493`*^9}, {3.8895065436369247`*^9, 
   3.88950657275235*^9}, 3.8895149533678937`*^9, {3.8895149993216553`*^9, 
   3.889515032043041*^9}, {3.8895151569178467`*^9, 3.889515208680502*^9}, {
   3.8895154088070097`*^9, 3.889515432071745*^9}, {3.8895154631440167`*^9, 
   3.8895154716073956`*^9}, 3.889521698973751*^9, 3.889542273491522*^9, {
   3.889542417716914*^9, 3.8895424205438766`*^9}, {3.8896732982589235`*^9, 
   3.889673300499333*^9}, {3.8896735272522445`*^9, 3.889673530888175*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"7cb0c9f0-219e-4ceb-a9f8-6cef24924825"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896272939909973`*^9, 3.889627295705911*^9}, {
   3.8896273882560053`*^9, 3.889627406136615*^9}, 3.8896274400713534`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"200c9b7b-7fc8-42af-adf1-31b97d292ad2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListPlot3D", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"LapEigenvalues", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", ";;", ",", "kz"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ky\>\"", ",", "\"\<kx\>\"", ",", "\"\<Energy\>\""}], 
        "}"}]}], ",", 
      RowBox[{"Ticks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"kTicks", ",", "kTicks", ",", "Automatic"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<kz = \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"\[Pi]", "*", 
          RowBox[{"kz", "/", "systemLengthZ"}]}], "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"kz", ",", "1", ",", "systemLengthZ", ",", "1"}], "}"}]}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"dataEigenvalues", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", ";;", ",", "kz"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<ky\>\"", ",", "\"\<kx\>\"", ",", "\"\<Energy\>\""}], 
       "}"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"kTicks", ",", "kTicks", ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\"\<kz = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[Pi]", "*", 
         RowBox[{"kz", "/", "systemLengthZ"}]}], "]"}]}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"kz", ",", "1", ",", "systemLengthZ", ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.889506238105935*^9, 3.8895062386839743`*^9}, {
   3.889514881322214*^9, 3.88951489454239*^9}, 3.8895422771547794`*^9, {
   3.889614156368865*^9, 3.8896141592020435`*^9}, {3.88967354086685*^9, 
   3.889673544549328*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"97e51c9a-9096-4512-bb3a-10aae72dd507"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`kz$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`kz$$], 1, 4, 1}}, Typeset`size$$ = {
    576., {281., 286.5036039378606}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`kz$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot3D[
        Transpose[
         Part[$CellContext`LapEigenvalues, 
          Span[1, All], 
          Span[1, All], $CellContext`kz$$], {3, 2, 1}], 
        AxesLabel -> {"ky", "kx", "Energy"}, 
        Ticks -> {$CellContext`kTicks, $CellContext`kTicks, Automatic}, 
        PlotRange -> All, ImageSize -> Large, PlotLabel -> 
        "kz = " <> ToString[
          Pi ($CellContext`kz$$/$CellContext`systemLengthZ)]], 
      "Specifications" :> {{$CellContext`kz$$, 1, 4, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{624., {325.1340333066308, 330.8659666933692}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.88967354537788*^9, {3.8896789249054556`*^9, 3.889678947558776*^9}, {
   3.889687924876551*^9, 3.889687931460024*^9}, {3.8896885190253735`*^9, 
   3.88968852887353*^9}, {3.8896886495758066`*^9, 3.889688667768892*^9}, {
   3.889688743967905*^9, 3.88968875322038*^9}, {3.889688834176755*^9, 
   3.8896888410806265`*^9}, 3.889691043782348*^9, 3.889691152248392*^9, 
   3.889691191944762*^9, {3.889691622896227*^9, 3.889691627623926*^9}, {
   3.8896927658226767`*^9, 3.8896927848765383`*^9}, {3.8896939042829185`*^9, 
   3.8896939098930335`*^9}, 3.8896949648184333`*^9, 3.894443392569617*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"29592cda-3870-4e88-b250-3a3a9a08505e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`kz$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`kz$$], 1, 4, 1}}, Typeset`size$$ = {
    576., {283., 286.768713462758}}, Typeset`update$$ = 0, Typeset`initDone$$,
     Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`kz$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot3D[
        Transpose[
         Part[$CellContext`dataEigenvalues, 
          Span[1, All], 
          Span[1, All], $CellContext`kz$$], {3, 2, 1}], 
        AxesLabel -> {"ky", "kx", "Energy"}, 
        Ticks -> {$CellContext`kTicks, $CellContext`kTicks, Automatic}, 
        PlotRange -> All, ImageSize -> Large, PlotLabel -> 
        "kz = " <> ToString[
          Pi ($CellContext`kz$$/$CellContext`systemLengthZ)]], 
      "Specifications" :> {{$CellContext`kz$$, 1, 4, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{624., {326.1340333066308, 331.8659666933692}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.88967354537788*^9, {3.8896789249054556`*^9, 3.889678947558776*^9}, {
   3.889687924876551*^9, 3.889687931460024*^9}, {3.8896885190253735`*^9, 
   3.88968852887353*^9}, {3.8896886495758066`*^9, 3.889688667768892*^9}, {
   3.889688743967905*^9, 3.88968875322038*^9}, {3.889688834176755*^9, 
   3.8896888410806265`*^9}, 3.889691043782348*^9, 3.889691152248392*^9, 
   3.889691191944762*^9, {3.889691622896227*^9, 3.889691627623926*^9}, {
   3.8896927658226767`*^9, 3.8896927848765383`*^9}, {3.8896939042829185`*^9, 
   3.8896939098930335`*^9}, 3.8896949648184333`*^9, 3.894443392845683*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"a3cad504-81dc-4994-8408-f8fca4a0e9d2"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "argx", 
   "\"\\!\\(\\*RowBox[{\\\"Symbol\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\
\\\"}]\\) arguments; 1 argument is expected.\"", 2, 19, 3, 
   26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.904788000189947*^9},
 CellLabel->"",ExpressionUUID->"53b2aa53-0057-4c54-a246-a25b7780c06e"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"False\\\", \\\",\\\", \\\"True\\\"}], \\\"]\\\"}]\\).\"", 2, 19, 
   4, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880011608524`*^9},
 CellLabel->"",ExpressionUUID->"1825cbbd-9c23-4d82-91f5-0f1d4564f06f"],

Cell[BoxData[
 TemplateBox[{
  "ListPlot3D", "arrayerr", 
   "\"\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Symbol\\\", \\\"[\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"2.`\\\", \\\",\\\", \
\\\"1.`\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) must be a valid array or a list \
of valid arrays.\"", 2, 19, 5, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.90478800132388*^9},
 CellLabel->"",ExpressionUUID->"fe5f967f-a1d6-4313-9160-6e4f80455965"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "argx", 
   "\"\\!\\(\\*RowBox[{\\\"Symbol\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\
\\\"}]\\) arguments; 1 argument is expected.\"", 2, 19, 6, 
   26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880014229097`*^9},
 CellLabel->"",ExpressionUUID->"ea49d8ec-6bd1-4219-9db5-c2af79d6f07c"],

Cell[BoxData[
 TemplateBox[{
  "Transpose", "permspec", 
   "\"Invalid permutation specification found at position \\!\\(\\*RowBox[{\\\
\"2\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{\\\"False\\\", \\\",\\\", \\\"True\\\"}], \\\"]\\\"}]\\).\"", 2, 19, 
   7, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880015479245`*^9},
 CellLabel->"",ExpressionUUID->"9994b87d-f889-414d-ae9f-23be665239f3"],

Cell[BoxData[
 TemplateBox[{
  "ListPlot3D", "arrayerr", 
   "\"\\!\\(\\*RowBox[{\\\"Transpose\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Symbol\\\", \\\"[\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\
\"{\\\", RowBox[{\\\"3.`\\\", \\\",\\\", \\\"2.`\\\", \\\",\\\", \
\\\"1.`\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) must be a valid array or a list \
of valid arrays.\"", 2, 19, 8, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.90478800164528*^9},
 CellLabel->"",ExpressionUUID->"476643ee-f26c-42bf-a33f-7fd2dc56106a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8896740365781527`*^9, 3.889674036650548*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"8d44c3ee-3f1f-4c37-9556-16c381e7e386"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"laplacianMatrixFourier", "=", " ", 
    RowBox[{"totalNodeConductanceMatrixFourier", "-", 
     RowBox[{"(", 
      RowBox[{
      "adjacencyMatrixXToXFourier", "+", 
       "adjacencyMatrixXToYDifferentCellFourier", "+", 
       "adjacencyMatrixXToYSameCellFourier", "+", "adjacencyMatrixZ"}], ")"}],
      "+", "circuitGroundMatrixFourier"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"laplacianMatrixFourier", "//", 
  "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"laplacianMatrixFourier", "-", 
   RowBox[{"Transpose", "[", "laplacianMatrixFourier", "]"}]}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8896741199294696`*^9, 3.8896741355648317`*^9}, {
  3.8896768504270926`*^9, 3.8896768512546635`*^9}, {3.8896787670175376`*^9, 
  3.889678770868077*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"0bde525a-119a-466f-b53d-465e6c591669"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{{3.8896741218525233`*^9, 3.88967413609671*^9}, 
   3.889676851706489*^9, 3.889678771229873*^9, 3.889678925868043*^9, 
   3.8896879259289937`*^9, 3.8896885196795206`*^9, 3.889688650512375*^9, 
   3.8896927669563484`*^9, 3.889693905145237*^9, 3.894443393190751*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"d20f4107-6394-4686-9426-dbbfa0014345"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00235785100876882`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0", "0", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8896741218525233`*^9, 3.88967413609671*^9}, 
   3.889676851706489*^9, 3.889678771229873*^9, 3.889678925868043*^9, 
   3.8896879259289937`*^9, 3.8896885196795206`*^9, 3.889688650512375*^9, 
   3.8896927669563484`*^9, 3.889693905145237*^9, 3.8944433933740053`*^9},
 CellLabel->
  "Out[71]//MatrixForm=",ExpressionUUID->"b6439137-86b8-4e83-ba36-\
9a8c528b402a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coordConvention", "[", 
       RowBox[{"[", "x", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"coordConvention", "[", 
       RowBox[{"[", "y", "]"}], "]"}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], "-", 
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
           "NUnit", ",", "1"}], "]"}], ",", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "3"}], "]"}], "]"}], "-", 
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "3"}], "]"}], "]"}]}], ",", "systemLengthZ", 
           ",", "1"}], "]"}], ",", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "4"}], "]"}], "]"}], "-", 
            RowBox[{"coordConvention", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "4"}], "]"}], "]"}]}], ",", "2", ",", "1"}], 
          "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"laplacianMatrixFourier", "[", 
       RowBox[{"[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "}"}], "//", "MatrixForm"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", 
     RowBox[{"Length", "[", "coordConvention", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "1", ",", 
     RowBox[{"Length", "[", "coordConvention", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8896740435562468`*^9, 3.889674060376224*^9}, {
  3.8896747471774797`*^9, 3.8896748064528103`*^9}, {3.8896748576285486`*^9, 
  3.8896748624213963`*^9}, {3.8896775361167603`*^9, 3.889677584510597*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"711a57a7-d0a0-4b9c-8e0e-2a4d1bf28e62"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = 1, $CellContext`y$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`x$$], 1, 32, 1}, {
      Hold[$CellContext`y$$], 1, 32, 1}}, Typeset`size$$ = {
    140.60253860466185`, {28.93403328722343, 34.665966712776566`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`x$$ = 1, $CellContext`y$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[{
         Part[$CellContext`coordConvention, $CellContext`x$$], 
         Part[$CellContext`coordConvention, $CellContext`y$$], 
         Flatten[{
           Mod[
           Part[$CellContext`coordConvention, $CellContext`y$$, {1, 2}] - 
            Part[$CellContext`coordConvention, $CellContext`x$$, {1, 
             2}], $CellContext`NUnit, 1], 
           Mod[
           Part[$CellContext`coordConvention, $CellContext`y$$, 3] - 
            Part[$CellContext`coordConvention, $CellContext`x$$, 
             3], $CellContext`systemLengthZ, 1], 
           Mod[
           Part[$CellContext`coordConvention, $CellContext`y$$, 4] - 
            Part[$CellContext`coordConvention, $CellContext`x$$, 4], 2, 1]}], 
         Part[$CellContext`laplacianMatrixFourier, $CellContext`x$$, \
$CellContext`y$$]}], 
      "Specifications" :> {{$CellContext`x$$, 1, 32, 1}, {$CellContext`y$$, 1,
          32, 1}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{245., {84.13403330663076, 89.86596669336924}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.889674062413446*^9, {3.889674748719591*^9, 3.8896747527474384`*^9}, {
   3.889674807177504*^9, 3.8896748147116785`*^9}, {3.889675376568271*^9, 
   3.8896753867427063`*^9}, {3.8896763599720287`*^9, 
   3.8896763642015452`*^9}, {3.8896766237796926`*^9, 
   3.8896766290692897`*^9}, {3.8896768553256907`*^9, 3.889676858489748*^9}, {
   3.8896775854000664`*^9, 3.8896776115535173`*^9}, 3.889678929273125*^9, 
   3.8896879290264816`*^9, 3.8896885218216248`*^9, 3.8896886537135973`*^9, 
   3.8896927709280596`*^9, 3.889693907195597*^9, {3.889693986540117*^9, 
   3.8896939878156824`*^9}, 3.894443393632062*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"7be91543-5052-4995-9cee-85c5744a7e5c"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"coordConvention\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 19, 9, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880017939153`*^9},
 CellLabel->"",ExpressionUUID->"28fd60fa-7c4f-42dd-99be-18e66dbef230"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"coordConvention\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 19, 10, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880019231*^9},
 CellLabel->"",ExpressionUUID->"4a90f75c-8f2a-49d5-bbbc-d73eb8020e92"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"coordConvention\\\", \\\"\
\[LeftDoubleBracket]\\\", RowBox[{\\\"1\\\", \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"}\\\"}]}], \\\"\
\[RightDoubleBracket]\\\"}]\\) is longer than depth of object.\"", 2, 19, 11, 
   26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9047880020440664`*^9},
 CellLabel->"",ExpressionUUID->"ff5c67c5-9b8a-4428-9343-7edbfb586ee2"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 19, 12, 26672869311400963274, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.904788002171249*^9},
 CellLabel->"",ExpressionUUID->"6aa05657-fc6d-434c-a1a5-49f95b502dcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"I", "*", "driveFreq", "*", "C1Value"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8896940469961057`*^9, 3.889694058538241*^9}, 
   3.8896941314965935`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"d8a436f0-d074-40aa-a956-e4ee12d74784"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.002356194490192345`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.8896940545079975`*^9, 3.8896940592720275`*^9}, 
   3.8896941322277765`*^9, 3.894443393870119*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"7dd4eac9-df9f-4e65-afec-94f314eb2728"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"laplacianMatrixFourier", "-", 
   RowBox[{"Transpose", "[", "laplacianMatrixFourier", "]"}]}], "//", 
  "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.8896941630990224`*^9, 3.8896941792942276`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"27bae7f0-f89b-497b-9190-b484ba7f28d1"],

Cell[BoxData[
 GraphicsBox[
  RasterBox[SparseArray[
   Automatic, {32, 32}, 1., {
    1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
       20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32}, {{26}, {25}, {
      28}, {27}, {30}, {29}, {32}, {31}, {18}, {17}, {20}, {19}, {22}, {21}, {
      24}, {23}, {10}, {9}, {12}, {11}, {14}, {13}, {16}, {15}, {2}, {1}, {
      4}, {3}, {6}, {5}, {8}, {7}}}, {1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 
     1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 
     1., 1., 1., 1.}}], {{0, 0}, {32, 32}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{31.5, 
       FormBox["1", TraditionalForm]}, {22.5, 
       FormBox["10", TraditionalForm]}, {12.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["32", TraditionalForm]}}, {{31.5, 
       FormBox["1", TraditionalForm]}, {22.5, 
       FormBox["10", TraditionalForm]}, {12.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["32", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {31.5, 
       FormBox["32", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {31.5, 
       FormBox["32", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.8896941722665663`*^9, 3.889694180135522*^9}, 
   3.8944433941617002`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"b9c7620c-628b-49c0-afab-d8885cd2714a"]
}, Open  ]]
},
WindowSize->{1053.4153846153847`, 526.7076923076924},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f8367245-d3ad-4cb2-8bcc-a9379202c3bd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4102, 82, 219, "Input",ExpressionUUID->"5a8bc8a3-0ff6-4941-b58e-92ea8b66094b"],
Cell[4663, 104, 172, 2, 28, "Input",ExpressionUUID->"c8bedccd-63d7-45ec-a0b6-eb7f6167c74c"],
Cell[CellGroupData[{
Cell[4860, 110, 6867, 146, 485, "Input",ExpressionUUID->"8c2efa85-94ab-4fb2-8a07-fef51bba2526"],
Cell[11730, 258, 388, 9, 28, "Message",ExpressionUUID->"83b53fe5-ad0e-41cb-a8d2-18cd1f56d938"],
Cell[12121, 269, 390, 9, 28, "Message",ExpressionUUID->"3bd083f4-7551-451d-a6e2-76b2647b1179"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12548, 283, 387, 10, 28, "Input",ExpressionUUID->"c7600bcb-cb72-4887-a260-c2b18d7003e3"],
Cell[12938, 295, 196, 2, 54, "Output",ExpressionUUID->"2aa05d0e-3b68-48ca-9f77-5375deb6a2af"]
}, Open  ]],
Cell[13149, 300, 319, 4, 28, "Input",ExpressionUUID->"17d59b2e-305a-488c-b1c1-2ca7151afe26"],
Cell[13471, 306, 17801, 381, 854, "Input",ExpressionUUID->"da730eb1-5fb4-4cac-a0a4-1deb7cb7d319"],
Cell[31275, 689, 175, 2, 28, "Input",ExpressionUUID->"979ac351-b1b9-499a-b256-70ae96d9602f"],
Cell[31453, 693, 899, 18, 105, "Input",ExpressionUUID->"37648ec5-5756-45f3-b7f5-5d5c884aa147"],
Cell[32355, 713, 175, 2, 28, "Input",ExpressionUUID->"a2d44bb7-3391-49e1-a24a-d9c7aa0ce0af"],
Cell[32533, 717, 3325, 77, 238, "Input",ExpressionUUID->"eb0e819c-2372-4237-b1b8-d2357759fece"],
Cell[35861, 796, 273, 4, 28, "Input",ExpressionUUID->"85a9a6a9-3a51-4a23-a6e2-958dfeb210d5"],
Cell[CellGroupData[{
Cell[36159, 804, 261, 5, 28, "Input",ExpressionUUID->"a86c699f-9b03-41ae-a977-7681a26500b5"],
Cell[36423, 811, 988, 24, 32, "Output",ExpressionUUID->"4f227c5d-adab-4e28-89db-830227246d41"]
}, Open  ]],
Cell[37426, 838, 7624, 171, 395, "Input",ExpressionUUID->"8029e452-70c9-4ece-a71b-a5d25548e1cb"],
Cell[45053, 1011, 171, 2, 28, "Input",ExpressionUUID->"5dfee06a-2bd0-4586-809a-9b07d7bb18d1"],
Cell[45227, 1015, 1866, 49, 105, "Input",ExpressionUUID->"73fe7c12-3fec-4780-94dc-712e906e11ba"],
Cell[47096, 1066, 175, 2, 28, "Input",ExpressionUUID->"25bdecf6-4d38-48fe-aefa-114509e5b4dd"],
Cell[47274, 1070, 1267, 31, 67, "Input",ExpressionUUID->"d87f1c92-24a6-4e81-a13a-b4101b0034df"],
Cell[48544, 1103, 148, 2, 28, "Input",ExpressionUUID->"f24fbea8-4e16-4901-8848-e8e01649ae67"],
Cell[48695, 1107, 5577, 132, 238, "Input",ExpressionUUID->"5293880b-db2c-418b-b625-f28d50d90714"],
Cell[54275, 1241, 173, 2, 28, "Input",ExpressionUUID->"5dd63fd1-ee61-4209-816c-9258b50e8ee1"],
Cell[54451, 1245, 7020, 179, 569, "Input",ExpressionUUID->"58ad1f8b-3a1b-440a-9db6-02bd75456665"],
Cell[61474, 1426, 224, 3, 28, "Input",ExpressionUUID->"e93742e9-354b-43c5-a7b9-763b2eb32bcc"],
Cell[61701, 1431, 2913, 77, 142, "Input",ExpressionUUID->"7cb0c9f0-219e-4ceb-a9f8-6cef24924825"],
Cell[64617, 1510, 249, 3, 28, "Input",ExpressionUUID->"200c9b7b-7fc8-42af-adf1-31b97d292ad2"],
Cell[CellGroupData[{
Cell[64891, 1517, 2527, 62, 143, "Input",ExpressionUUID->"97e51c9a-9096-4512-bb3a-10aae72dd507"],
Cell[67421, 1581, 2565, 49, 675, "Output",ExpressionUUID->"29592cda-3870-4e88-b250-3a3a9a08505e"],
Cell[69989, 1632, 2565, 49, 677, "Output",ExpressionUUID->"a3cad504-81dc-4994-8408-f8fca4a0e9d2"],
Cell[72557, 1683, 377, 8, 28, "Message",ExpressionUUID->"53b2aa53-0057-4c54-a246-a25b7780c06e"],
Cell[72937, 1693, 472, 9, 28, "Message",ExpressionUUID->"1825cbbd-9c23-4d82-91f5-0f1d4564f06f"],
Cell[73412, 1704, 553, 10, 28, "Message",ExpressionUUID->"fe5f967f-a1d6-4313-9160-6e4f80455965"],
Cell[73968, 1716, 379, 8, 28, "Message",ExpressionUUID->"ea49d8ec-6bd1-4219-9db5-c2af79d6f07c"],
Cell[74350, 1726, 472, 9, 28, "Message",ExpressionUUID->"9994b87d-f889-414d-ae9f-23be665239f3"],
Cell[74825, 1737, 553, 10, 28, "Message",ExpressionUUID->"476643ee-f26c-42bf-a33f-7fd2dc56106a"]
}, Open  ]],
Cell[75393, 1750, 173, 2, 28, "Input",ExpressionUUID->"8d44c3ee-3f1f-4c37-9556-16c381e7e386"],
Cell[CellGroupData[{
Cell[75591, 1756, 942, 21, 124, "Input",ExpressionUUID->"0bde525a-119a-466f-b53d-465e6c591669"],
Cell[76536, 1779, 437, 7, 32, "Output",ExpressionUUID->"d20f4107-6394-4686-9426-dbbfa0014345"],
Cell[76976, 1788, 24569, 488, 564, "Output",ExpressionUUID->"b6439137-86b8-4e83-ba36-9a8c528b402a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101582, 2281, 2409, 61, 86, "Input",ExpressionUUID->"711a57a7-d0a0-4b9c-8e0e-2a4d1bf28e62"],
Cell[103994, 2344, 3132, 59, 193, "Output",ExpressionUUID->"7be91543-5052-4995-9cee-85c5744a7e5c"],
Cell[107129, 2405, 429, 8, 28, "Message",ExpressionUUID->"28fd60fa-7c4f-42dd-99be-18e66dbef230"],
Cell[107561, 2415, 426, 8, 28, "Message",ExpressionUUID->"4a90f75c-8f2a-49d5-bbbc-d73eb8020e92"],
Cell[107990, 2425, 532, 10, 28, "Message",ExpressionUUID->"ff5c67c5-9b8a-4428-9343-7edbfb586ee2"],
Cell[108525, 2437, 416, 8, 28, "Message",ExpressionUUID->"6aa05657-fc6d-434c-a1a5-49f95b502dcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108978, 2450, 272, 5, 28, "Input",ExpressionUUID->"d8a436f0-d074-40aa-a956-e4ee12d74784"],
Cell[109253, 2457, 326, 5, 32, "Output",ExpressionUUID->"7dd4eac9-df9f-4e65-afec-94f314eb2728"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109616, 2467, 313, 6, 28, "Input",ExpressionUUID->"27bae7f0-f89b-497b-9190-b484ba7f28d1"],
Cell[109932, 2475, 2186, 45, 376, "Output",ExpressionUUID->"b9c7620c-628b-49c0-afab-d8885cd2714a"]
}, Open  ]]
}
]
*)

